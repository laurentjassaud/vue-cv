<template>
    <div id="content-grid">
        <!-- NIVEAU #1 -->
        <div id="grid-niveau-1" class="content-grid__container font-base" ref="grid1">
            <div data-start="1,1" data-end="5,1">
                <div class="font-6 white up black">
                    <span>Jassaud</span>    
                </div>
            </div>            
            <div data-start="16,1" data-end="16,6">
                <div class="nav">
                    <span class="font-0 white up">expériences</span>
                    <i>
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
                            <path d="M190.5 66.9l22.2-22.2c9.4-9.4 24.6-9.4 33.9 0L441 239c9.4 9.4 9.4 24.6 0 
                            33.9L246.6 467.3c-9.4 9.4-24.6 9.4-33.9 0l-22.2-22.2c-9.5-9.5-9.3-25 .4-34.3L311.4 
                            296H24c-13.3 0-24-10.7-24-24v-32c0-13.3 10.7-24 24-24h287.4L190.9 101.2c-9.8-9.3-10-24.8-.4-34.3z"/>
                        </svg>
                    </i>                    
                </div>
            </div>                  
            <div data-start="1,2" data-end="4,2">
                <div class="font-5 white up">
                    <span class="dec-1">Laurent</span>                         
                </div>
            </div>
            <div data-start="8,2" data-end="11,2">
                <div class="font-1 white up">
                    <span class="dec-1">CREATIVE FRONT END DEVELOPER<br>UI/UX DESIGNER</span>                         
                </div>
            </div>
            <div data-start="7,3" data-end="7,3">
                <div class="font-6 white black">
                    <span class="dec-1">&</span>                         
                </div>
            </div>
            <div data-start="8,4" data-end="11,4">
                <div class="font-1 white up">
                    <span class="dec-1">SENIOR<br>Interactive Designer</span>                         
                </div>
            </div>
            <div data-start="1,5" data-end="2,7">
                <div class="font-000 white">
                    <span class="dec-1 light l-5">Collaborer sur des projets multimédias innovants et marier la technologie à la créativité.</span>                         
                </div>
            </div>            
            <div data-start="4,6" data-end="5,8">
                <div class="font-000 white">
                    <span class="dec-1 light l-5">Pouvoir raconter avec le client la plus belle des histoires, la sienne.</span>                         
                </div>
            </div>            
            <div data-start="8,6" data-end="10,6">
                <div class="bg-white">                  
                </div>
            </div>
            <div data-start="11,7" data-end="13,7">
                <div class="bg-white">                      
                </div>
            </div>
            <div data-start="14,8" data-end="15,8">
                <div class="bg-white">                    
                </div>
            </div>
        </div>
        <!-- FIN NIVEAU #1 -->
        <!-- NIVEAU #2 -->
        <div id="grid-niveau-2" class="content-grid__container font-base" ref="grid2">
            <div data-start="16,1" data-end="16,6">
                <div class="nav">
                    <span class="font-0 white up">compétences</span>
                    <i>
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
                            <path d="M190.5 66.9l22.2-22.2c9.4-9.4 24.6-9.4 33.9 0L441 239c9.4 9.4 9.4 24.6 0 
                            33.9L246.6 467.3c-9.4 9.4-24.6 9.4-33.9 0l-22.2-22.2c-9.5-9.5-9.3-25 .4-34.3L311.4 
                            296H24c-13.3 0-24-10.7-24-24v-32c0-13.3 10.7-24 24-24h287.4L190.9 101.2c-9.8-9.3-10-24.8-.4-34.3z"/>
                        </svg>
                    </i>                      
                </div>
            </div> 
            <div data-start="1,1" data-end="2,12">
                <div class="experience black white up">
                    <h5>Expériences</h5>
                </div>
            </div>
            <div data-start="8,3" data-end="14,5">
                <div class="redactionnel">
                    <div class="bloc-cv experience">
                        <ul>
                            <li> 
                                <span class="function font-2 white">Directeur Artistique</span>
                                <span class="font-0 white">HDR Communications - Obernai</span>
                                <span class="date font-000 white">2015 - 2017</span>
                            </li>
                            <li>
                                <span class="function font-2 white">Graphiste FreeLance</span>
                                <span class="font-0 white">Travail avec diverses agences comme Grafiti, Get Groupe</span>
                                <span class="date font-000 white">2012 - 2015</span>
                            </li>
                            <li>
                                <span class="function font-2 white">Webdesigner - Développeur front&#x2011;end</span>
                                <span class="font-0 white">SdV plurimedia - Strasbourg</span>
                                <span class="date font-000 white">2006 - 2012</span>
                            </li>
                        </ul>               
                    </div>   
                </div>                                   
            </div>
        </div>
        <!-- FIN NIVEAU #2 -->
        <!-- NIVEAU #3 -->
        <div id="grid-niveau-3" class="content-grid__container font-base" ref="grid3">
            <div data-start="16,1" data-end="16,6">
                <div class="nav">
                    <span class="font-0 noir up">réalisations</span>
                    <i class="noir">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
                            <path d="M190.5 66.9l22.2-22.2c9.4-9.4 24.6-9.4 33.9 0L441 239c9.4 9.4 9.4 24.6 0 
                            33.9L246.6 467.3c-9.4 9.4-24.6 9.4-33.9 0l-22.2-22.2c-9.5-9.5-9.3-25 .4-34.3L311.4 
                            296H24c-13.3 0-24-10.7-24-24v-32c0-13.3 10.7-24 24-24h287.4L190.9 101.2c-9.8-9.3-10-24.8-.4-34.3z"/>
                        </svg>
                    </i>                      
                </div>
            </div> 
            <div data-start="1,1" data-end="2,12">
                <div class="competences black noir up">
                    <h5>Compétences</h5>
                </div>
            </div>
            <div data-start="8,3" data-end="14,5">
                <div class="redactionnel">
                    <div class="bloc-cv competences">
                        <ul>
                            <li class="font-0 noir"> 
                                <span class="important">Javascript</span> dont ReactJS, Vue.js, gsap ainsi que le task-runner Webpack
                            </li>
                            <li class="font-0 noir">
                                <span class="important">HTML5</span> et l'optimisation pour mobile et tablette
                            </li>
                            <li class="font-0 noir">
                                <span class="important">CSS3</span> avec le framework css bootstrap, les animations et le preprocesseur SASS
                            </li>
                            <li class="font-0 noir">
                                <span class="important">Design Graphique</span> créativité et régles de mises en page
                            </li>
                            <li class="font-0 noir">
                                <span class="important">Suite Adobe</span> Dont After Effects 
                            </li>
                            <li class="font-0 noir">
                                <span class="important">Illustration</span> traditionelle ou vectorielle
                            </li>
                        </ul>               
                    </div>
                </div>
            </div>
        </div>  
        <!-- FIN NIVEAU #3 -->
        <!-- NIVEAU #4 -->
        <div id="grid-niveau-4" class="content-grid__container font-base" ref="grid4">
            <div data-start="16,1" data-end="16,6">
                <div class="nav">
                    <span class="font-000 white up">contact</span>
                    <i>
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
                            <path d="M190.5 66.9l22.2-22.2c9.4-9.4 24.6-9.4 33.9 0L441 239c9.4 9.4 9.4 24.6 0 
                            33.9L246.6 467.3c-9.4 9.4-24.6 9.4-33.9 0l-22.2-22.2c-9.5-9.5-9.3-25 .4-34.3L311.4 
                            296H24c-13.3 0-24-10.7-24-24v-32c0-13.3 10.7-24 24-24h287.4L190.9 101.2c-9.8-9.3-10-24.8-.4-34.3z"/>
                        </svg>
                    </i>                  
                </div>
            </div> 
            <div data-start="1,1" data-end="2,12">
                <div class="works black white up">
                    <h5>Réalisations</h5>
                </div>
            </div>
            <div data-start="8,3" data-end="14,5">
                <div class="redactionnel">
                    <div class="bloc-cv works">
                        <ul>                            
                            <li v-for="(project, index) in refProjects" class="font-0 white" :key="project.ref"
                                @click.prevent="actionModal(index)">
                                <i class="puce-work">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                                        <path d="M504 256C504 119 393 8 256 8S8 119 8 256s111 248 248 248 248-111 248-248zm-448 
                                        0c0-110.5 89.5-200 200-200s200 89.5 200 200-89.5 200-200 200S56 366.5 56 256zm72 
                                        20v-40c0-6.6 5.4-12 12-12h116v-67c0-10.7 12.9-16 20.5-8.5l99 99c4.7 4.7 4.7 12.3 0 
                                        17l-99 99c-7.6 7.6-20.5 2.2-20.5-8.5v-67H140c-6.6 0-12-5.4-12-12z"/>
                                    </svg>
                                </i>
                                {{project.nom}}
                            </li>
                        </ul>   
           
                    </div>
                </div>
            </div>
        </div>  
        <!-- FIN NIVEAU #4 -->
        <!-- NIVEAU #5 -->
        <div id="grid-niveau-5" class="content-grid__container font-base" ref="grid5">
            <div data-start="16,1" data-end="16,6">
            </div> 
            <div data-start="1,1" data-end="2,12">
                <div class="contact black white up">
                    <h5>Contact</h5>
                </div>
            </div>
            <div data-start="8,3" data-end="14,5">
                <div class="redactionnel">
                    <div class="bloc-cv contact">
                        <p class="contact font-0 white">
                            <span>25, rue des Frères</span><br>
                            <span>67000 Strasbourg</span><br>
                            <span class="font-3 black font-2">07.87.411.477</span><br>
                            <span>l.jassaud@gmail.com</span><br>
                            <a class="ref-git" href="https://github.com/laurentjassaud" title="My Github">                                
                                <i class="logo-git">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
                                        <path d="M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 
                                        0 48-21.5 48-48V80c0-26.5-21.5-48-48-48zM277.3 415.7c-8.4 1.5-11.5-3.7-11.5-8 
                                        0-5.4.2-33 .2-55.3 0-15.6-5.2-25.5-11.3-30.7 37-4.1 76-9.2 76-73.1 
                                        0-18.2-6.5-27.3-17.1-39 1.7-4.3 7.4-22-1.7-45-13.9-4.3-45.7 17.9-45.7 
                                        17.9-13.2-3.7-27.5-5.6-41.6-5.6-14.1 0-28.4 1.9-41.6 5.6 0 0-31.8-22.2-45.7-17.9-9.1 
                                        22.9-3.5 40.6-1.7 45-10.6 11.7-15.6 20.8-15.6 39 0 63.6 37.3 69 74.3 73.1-4.8 4.3-9.1 
                                        11.7-10.6 22.3-9.5 4.3-33.8 11.7-48.3-13.9-9.1-15.8-25.5-17.1-25.5-17.1-16.2-.2-1.1 
                                        10.2-1.1 10.2 10.8 5 18.4 24.2 18.4 24.2 9.7 29.7 56.1 19.7 56.1 19.7 0 13.9.2 36.5.2 
                                        40.6 0 4.3-3 9.5-11.5 8-66-22.1-112.2-84.9-112.2-158.3 0-91.8 70.2-161.5 162-161.5S388 
                                        165.6 388 257.4c.1 73.4-44.7 136.3-110.7 158.3zm-98.1-61.1c-1.9.4-3.7-.4-3.9-1.7-.2-1.5 
                                        1.1-2.8 3-3.2 1.9-.2 3.7.6 3.9 1.9.3 1.3-1 2.6-3 3zm-9.5-.9c0 1.3-1.5 2.4-3.5 
                                        2.4-2.2.2-3.7-.9-3.7-2.4 0-1.3 1.5-2.4 3.5-2.4 1.9-.2 3.7.9 3.7 
                                        2.4zm-13.7-1.1c-.4 1.3-2.4 1.9-4.1 1.3-1.9-.4-3.2-1.9-2.8-3.2.4-1.3 
                                        2.4-1.9 4.1-1.5 2 .6 3.3 2.1 2.8 3.4zm-12.3-5.4c-.9 1.1-2.8.9-4.3-.6-1.5-1.3-1.9-3.2-.9-4.1.9-1.1 2.8-.9 
                                        4.3.6 1.3 1.3 1.8 3.3.9 4.1zm-9.1-9.1c-.9.6-2.6 0-3.7-1.5s-1.1-3.2 0-3.9c1.1-.9 2.8-.2 3.7 1.3 1.1 1.5 1.1 3.3 
                                        0 4.1zm-6.5-9.7c-.9.9-2.4.4-3.5-.6-1.1-1.3-1.3-2.8-.4-3.5.9-.9 2.4-.4 3.5.6 1.1 1.3 1.3 2.8.4 3.5zm-6.7-7.4c-.4.9-1.7 
                                        1.1-2.8.4-1.3-.6-1.9-1.7-1.5-2.6.4-.6 1.5-.9 2.8-.4 1.3.7 1.9 1.8 1.5 2.6z"/>
                                    </svg>
                                </i>
                                <span class="light font-4">Mon GitHub</span>
                            </a>                             
                        </p>
                                  
                    </div>
                </div>
            </div>
        </div>  
        <!-- FIN NIVEAU #5 -->
    </div>
</template>

<script>
    
    import { mapGetters, mapActions  } from 'vuex'
    import config from '../config.json'
    import GridCreator from '../class/gridCreator' 
    import { EventBus } from '../event-bus.js'  
    import ImgModal from './ImgModal.vue' 

    export default {

        name: 'ContentGrid',

        data() {
            return { 
                refProjects: config.content,
                grid1_large: [
                    {start: '1,1', end: '7,1'},
                    {start: '16,6', end: '16,8'},
                    {start: '1,2', end: '4,2'},
                    {start: '8,3', end: '11,3'},
                    {start: '7,4', end: '7,4'},
                    {start: '8,5', end: '11,5'},
                    {start: '1,5', end: '3,7'},
                    {start: '3,6', end: '5,8'},
                    {start: '8,6', end: '11,6'},
                    {start: '11,7', end: '14,7'},
                    {start: '14,8', end: '16,8'}
                ],
                grid1_small_portrait: [
                    {start: '4,2', end: '11,4'},
                    {start: '1,14', end: '1,19'},
                    {start: '4,4', end: '9,4'},
                    {start: '4,7', end: '12,7'},
                    {start: '3,8', end: '3,9'},
                    {start: '4,9', end: '12,10'},
                    {start: '4,14', end: '7,18'},
                    {start: '7,15', end: '10,19'},
                    {start: '4,11', end: '7,12'},
                    {start: '7,12', end: '10,13'},
                    {start: '10,13', end: '12,14'}
                ],
                grid1_small_landscape: [
                    {start: '2,2', end: '9,2'},
                    {start: '22,6', end: '22,10'},
                    {start: '2,3', end: '5,3'},
                    {start: '12,2', end: '21,4'},
                    {start: '11,4', end: '11,5'},
                    {start: '12,5', end: '21,7'},
                    {start: '2,6', end: '5,10'},
                    {start: '6,7', end: '9,11'},
                    {start: '12,7', end: '15,7'},
                    {start: '15,8', end: '18,8'},
                    {start: '18,9', end: '20,9'}
                ],
                grid2_large: [                    
                    {start: '16,6', end: '16,8'},
                    {start: '1,3', end: '1,6'},
                    {start: '2,3', end: '13,9'}
                ],
                grid2_small_portrait: [
                    {start: '1,13', end: '1,19'},
                    {start: '2,5', end: '4,11'},
                    {start: '4,5', end: '12,18'}
                ],
                grid2_small_landscape: [
                    {start: '22,6', end: '22,10'},
                    {start: '2,5', end: '2,11'},
                    {start: '4,5', end: '22,11'}
                ],
            }
        },

        mounted() {
            this.addListeners()
        },

        computed: {

            ...mapGetters({
				isMobile: 'isMobile',
				isPortrait: 'isPortrait',
				isLandscape: 'isLandscape',
                windowSize: 'windowSize',
                isModalOpen: 'isModalOpen'
            }),

            refImage() {
                let returnArray = []
                config.content.map( (img) =>{
                    if(this.isMobile) {
                        return returnArray = [...returnArray, img.image.mobile]
                    }else{
                        return returnArray = [...returnArray, img.image.desk]
                    }
                })
                return returnArray
            }
        },

    	methods: {       
            
			init(){ 
                // console.log('modal :',this.$modal)
                let gridChoice1 = null
                let gridChoice2 = null

                let initGrid = () => {
                    if(/*this.isMobile && */this.windowSize.BP === 'small' && this.windowSize.w < this.windowSize.h) {
                        gridChoice1 = this.grid1_small_portrait  
                        gridChoice2 = this.grid2_small_portrait 
                    }else if (/*this.isMobile && */this.windowSize.BP === 'small' && this.windowSize.w > this.windowSize.h) {
                        gridChoice1 = this.grid1_small_landscape  
                        gridChoice2 = this.grid2_small_landscape  
                    }else if(/*this.isMobile && */this.windowSize.BP === 'md' && this.windowSize.w < this.windowSize.h) {
                        gridChoice1 = this.grid1_small_portrait  
                        gridChoice2 = this.grid2_small_portrait 
                    }else if (/*this.isMobile && */this.windowSize.BP === 'md' && this.windowSize.w >= this.windowSize.h) {
                        gridChoice1 = this.grid1_large 
                        gridChoice2 = this.grid2_large
                    }else{
                        gridChoice1 = this.grid1_large   
                        gridChoice2 = this.grid2_large
                    }
                }

                let afficheGrid = () => {
                    this.grid1 = new GridCreator(this.$refs.grid1, 'ref', gridChoice1)
                    this.grid2 = new GridCreator(this.$refs.grid2, 'ref-xp', gridChoice2)
                    this.grid3 = new GridCreator(this.$refs.grid3, 'ref-comp', gridChoice2)
                    this.grid4 = new GridCreator(this.$refs.grid4, 'ref-work', gridChoice2)
                    this.grid5 = new GridCreator(this.$refs.grid5, 'ref-work', gridChoice2)
                }

                new Promise((resolve) => {
                    window.setInterval(() => {
                        initGrid()
                        if(gridChoice1 !== null && gridChoice2 !== null){
                            resolve()
                        }                        
                    }, 66)
                })
                .then(() => {
                    afficheGrid()
                    if(this.isMobile){
                        this.fixSize()
                    }
                    
                })            
                //this.debug()               
            },

			addListeners() {
                EventBus.$on('CHANGE_ORIENTATION', this.init)
                EventBus.$on('RESIZE', this.init)
            },           
              
            fixSize(){
                const viewPortHeight = document.getElementById('app').offsetHeight
                const windowHeight = window.innerHeight
                const centralElement = document.getElementById('content-grid')                
                centralElement.style.height = windowHeight + 'px'                          
                const centralBack = document.getElementById('back-grid')
                centralBack.style.height = windowHeight + 'px'
            },

            actionModal(refIndex) {
                const element = {}
                element.src = require('../assets/images/projets/' + this.refImage[refIndex])
                element.alt = this.refProjects[refIndex].nom
				this.$nextTick(() => EventBus.$emit('MODAL_OPEN', element))

            },

            debug() {

                if(this.debugElement) {
                    this.debugElement.innerHTML =''
                }
                this.debugElement= document.createElement('div')
                const off = document.getElementById('app').offsetHeight
                this.debugElement.className = 'debug'
                this.debugElement.innerHTML = `
                    mobile: ${this.isMobile} | 
                    hauteur: ${this.windowSize.h} / ${off} | 
                    portrait: ${this.isPortrait} |
                    BP: ${this.windowSize.BP}
                    `
                document.querySelector('body').appendChild(this.debugElement) 
            }
        }
    }

</script>